<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Control of tests • autotest</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Control of tests">
<meta property="og:description" content="autotest">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">autotest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2.059</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/autotest.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/autotest-control.html">Control of tests</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropenscilabs/autotest/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="autotest-control_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Control of tests</h1>
                        <h4 data-toc-skip class="author">Mark Padgham</h4>
            
            <h4 data-toc-skip class="date">2021-04-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropenscilabs/autotest/blob/master/vignettes/autotest-control.Rmd" class="external-link"><code>vignettes/autotest-control.Rmd</code></a></small>
      <div class="hidden name"><code>autotest-control.Rmd</code></div>

    </div>

    
    
<p>The <a href="https://ropenscilabs.github.io/autotest/articles/autotest.html">first vignette</a> demonstrates the process of applying <code>autotest</code> at all stages of package development. This vignette provides additional information for those applying <code>autotest</code> to already developed packages, in particular through describing how tests can be selectively applied to a package. By default the <a href="https://ropenscilabs.github.io/autotest/reference/autotest_package.html"><code>autotest_package()</code> function</a> tests an entire package, but testing can also be restricted to specified functions only. This vignette will demonstrate application to a few functions from the <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/00Index.html" class="external-link"><code>stats</code> package</a>, starting by loading the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span> <span class="op">(</span><span class="va"><a href="https://github.com/ropenscilabs/autotest" class="external-link">autotest</a></span><span class="op">)</span></code></pre></div>
<div id="rd-files-example-code-and-the-autotest-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#rd-files-example-code-and-the-autotest-workflow" class="anchor"></a>1. <code>.Rd</code> files, example code, and the autotest workflow</h2>
<p>To understand what <code>autotest</code> does, it is first necessary to understand a bit about the structure of documentation files for R package, which are contained in files called <code>".Rd"</code> files. Tests are constructed by parsing individual <code>.Rd</code> documentation files to extract the example code, identifying parameters passed to the specified functions, and mutating those parameters.</p>
<p>The general procedure can be illustrated by examining a specific function, for which we now choose the <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.html" class="external-link"><code>cor</code> function</a>, because of its relative simplicity. The following lines extract the documentation for the <code>cor</code> function, a <code>.html</code> version of which can be seen by clicking on the link above. Note that that web page reveals the name of the <code>.Rd</code> file to be “cor” (in the upper left corner), meaning that the name of the <code>.Rd</code> file is <code>"cor.Rd"</code>. The following lines extract that content, first by loading the entire <code>.Rd</code> database for the <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/00Index.html" class="external-link"><code>stats</code> package</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rd</span> <span class="op">&lt;-</span> <span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/Rdutils.html" class="external-link">Rd_db</a></span> <span class="op">(</span>package <span class="op">=</span> <span class="st">"stats"</span><span class="op">)</span>
<span class="va">cor_rd</span> <span class="op">&lt;-</span> <span class="va">rd</span> <span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span> <span class="op">(</span><span class="st">"^cor\\.Rd"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span> <span class="op">(</span><span class="va">rd</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p>The database itself is a list, with each entry holding the contents of one <code>.Rd</code> file in an object of class Rd, which is essentially a large nested list of components corresponding to the various <code>.Rd</code> tags such as <code>\arguments</code>, <code>\details</code>, and <code>\value</code>. An internal function from the <a href="https://stat.ethz.ch/R-manual/R-devel/library/tools/html/00Index.html" class="external-link"><code>tools</code> package</a> can be used to extract individual components (using the <code><a href="https://rdrr.io/r/base/ns-dblcolon.html" class="external-link">:::</a></code> notation to access internal functions). For example, a single <code>.Rd</code> file often describes the functionality of several functions, each of which is identified by specifying the function name as an <code>"alias"</code>. The aliases for the <code>"cor.Rd"</code> file are:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tools</span><span class="fu">:::</span><span class="fu">.Rd_get_metadata</span> <span class="op">(</span><span class="va">cor_rd</span>, <span class="st">"alias"</span><span class="op">)</span>
<span class="co">#&gt; [1] "var"     "cov"     "cor"     "cov2cor"</span></code></pre></div>
<p>This one file thus contains documentation for those four functions. Example code can be extracted with a dedicated function from the <a href="https://stat.ethz.ch/R-manual/R-devel/library/tools/html/Rd2HTML.html" class="external-link"><code>tools</code> package</a>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/Rd2HTML.html" class="external-link">Rd2ex</a></span> <span class="op">(</span><span class="va">cor_rd</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; ### Name: cor
#&gt; ### Title: Correlation, Variance and Covariance (Matrices)
#&gt; ### Aliases: var cov cor cov2cor
#&gt; ### Keywords: univar multivariate array
#&gt; 
#&gt; ### ** Examples
#&gt; 
#&gt; var(1:10)  # 9.166667
#&gt; 
#&gt; var(1:5, 1:5) # 2.5
#&gt; 
#&gt; ## Two simple vectors
#&gt; cor(1:10, 2:11) # == 1
#&gt; 
#&gt; ## Correlation Matrix of Multivariate sample:
#&gt; (Cl &lt;- cor(longley))
#&gt; ## Graphical Correlation Matrix:
#&gt; symnum(Cl) # highly correlated
#&gt; 
#&gt; ## Spearman's rho  and  Kendall's tau
#&gt; symnum(clS &lt;- cor(longley, method = "spearman"))
#&gt; symnum(clK &lt;- cor(longley, method = "kendall"))
#&gt; ## How much do they differ?
#&gt; i &lt;- lower.tri(Cl)
#&gt; cor(cbind(P = Cl[i], S = clS[i], K = clK[i]))
#&gt; 
#&gt; 
#&gt; ## cov2cor() scales a covariance matrix by its diagonal
#&gt; ##           to become the correlation matrix.
#&gt; cov2cor # see the function definition {and learn ..}
#&gt; stopifnot(all.equal(Cl, cov2cor(cov(longley))),
#&gt;           all.equal(cor(longley, method = "kendall"),
#&gt;             cov2cor(cov(longley, method = "kendall"))))
#&gt; 
#&gt; ##--- Missing value treatment:
#&gt; C1 &lt;- cov(swiss)
#&gt; range(eigen(C1, only.values = TRUE)$values) # 6.19        1921
#&gt; 
#&gt; ## swM := "swiss" with  3 "missing"s :
#&gt; swM &lt;- swiss
#&gt; colnames(swM) &lt;- abbreviate(colnames(swiss), min=6)
#&gt; swM[1,2] &lt;- swM[7,3] &lt;- swM[25,5] &lt;- NA # create 3 "missing"
#&gt; 
#&gt; ## Consider all 5 "use" cases :
#&gt; (C. &lt;- cov(swM)) # use="everything"  quite a few NA's in cov.matrix
#&gt; try(cov(swM, use = "all")) # Error: missing obs...
#&gt; C2 &lt;- cov(swM, use = "complete")
#&gt; stopifnot(identical(C2, cov(swM, use = "na.or.complete")))
#&gt; range(eigen(C2, only.values = TRUE)$values) # 6.46   1930
#&gt; C3 &lt;- cov(swM, use = "pairwise")
#&gt; range(eigen(C3, only.values = TRUE)$values) # 6.19   1938
#&gt; 
#&gt; ## Kendall's tau doesn't change much:
#&gt; symnum(Rc &lt;- cor(swM, method = "kendall", use = "complete"))
#&gt; symnum(Rp &lt;- cor(swM, method = "kendall", use = "pairwise"))
#&gt; symnum(R. &lt;- cor(swiss, method = "kendall"))
#&gt; 
#&gt; ## "pairwise" is closer componentwise,
#&gt; summary(abs(c(1 - Rp/R.)))
#&gt; summary(abs(c(1 - Rc/R.)))
#&gt; 
#&gt; ## but "complete" is closer in Eigen space:
#&gt; EV &lt;- function(m) eigen(m, only.values=TRUE)$values
#&gt; summary(abs(1 - EV(Rp)/EV(R.)) / abs(1 - EV(Rc)/EV(R.)))</code></pre>
<p>This is the entire content of the <code>\examples</code> portion of <code>"cor.Rd"</code>, as can be confirmed by comparing with the <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.html" class="external-link">online version</a>.</p>
</div>
<div id="internal-structure-of-the-autotest-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#internal-structure-of-the-autotest-workflow" class="anchor"></a>2. Internal structure of the <code>autotest</code> workflow</h2>
<p>For each <code>.Rd</code> file in a package, <code>autotest</code> tests the code given in the example section according to the following general steps:</p>
<ol style="list-style-type: decimal">
<li>Extract example lines from the <code>.Rd</code> file, as demonstrated above;</li>
<li>Identify all function <code>aliases</code> described by that file;</li>
<li>Identify all points at which those functions are called;</li>
<li>Identify all objects passed to those values, including values, classes, attributes, and other properties.</li>
<li>Identify any other parameters not explicitly passed in example code, but defined via default value;</li>
<li>Mutate the values of all parameters according to the kinds of test described in <a href="https://ropenscilabs.github.io/autotest/reference/autotest_types.html"><code>autotest_types()</code></a>.</li>
</ol>
<p>Calling <code><a href="../reference/autotest_package.html">autotest_package(..., test = FALSE)</a></code> implements the first 5 of those 6 steps, and returns data on all possible mutations of each parameter, while setting <code>test = TRUE</code> actually passes the mutated parameters to the specified functions, and returns reports on any unexpected behaviour.</p>
</div>
<div id="autotest-ing-the-statscov-function" class="section level2">
<h2 class="hasAnchor">
<a href="#autotest-ing-the-statscov-function" class="anchor"></a>3. <code>autotest</code>-ing the <code>stats::cov</code> function</h2>
<p>The preceding sections describe how <code>autotest</code> actually works, while the present section demonstrates how the package is typically used in practice. As demonstrated in the <a href="https://ropenscilabs.github.io/autotest/"><code>README</code></a>, information on all tests implemented within the package can be obtained by calling the <a href="https://ropenscilabs.github.io/autotest/reference/autotest_types.html"><code>autotest_types()</code> function</a>. The main function for testing package is <a href="https://ropenscilabs.github.io/autotest/reference/autotest_package.html"><code>autotest_package()</code></a>. The nominated package can be either an installed package, or the full path to a local directory containing a package’s source code. By default all <code>.Rd</code> files of a package are tested, with restriction to specified functions possible either by nominating functions to exclude from testing (via the <code>exclude</code> parameter), or functions to include (via the <code>functions</code> parameter). The <code>functions</code> parameter is intended to enable testing only of specified functions, while the <code>exclude</code> parameter is intended to enable testing of all functions except those specified with this parameter. Specifying values for both of these parameters is not generally recommended.</p>
<div id="listing-tests-without-conducting-them" class="section level3">
<h3 class="hasAnchor">
<a href="#listing-tests-without-conducting-them" class="anchor"></a>3.1 Listing tests without conducting them</h3>
<p>The following demonstrates the results of <code>autotest</code>-ing the <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.html" class="external-link"><code>cor</code> function</a> of the <code>stats</code> package, noting that the default call uses <code>test = FALSE</code>, and so returns details of all tests without actually implementing them (and for this reason we name the object <code>xf</code> for “false”):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autotest_package.html">autotest_package</a></span> <span class="op">(</span>package <span class="op">=</span> <span class="st">"stats"</span>,
                        functions <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; 
#&gt; ── autotesting stats ──
#&gt; 
#&gt; ✔ [1 / 4]: var
#&gt; ✔ [2 / 4]: cor
#&gt; ✔ [3 / 4]: cov
#&gt; ✔ [4 / 4]: cov</code></pre>
<p>That reveals that the example code from the <code>.Rd</code> file has four main points at which the aliases defined in that file are tested: once each for <code>var</code> and <code>cor</code>, and twice for <code>cov</code>. The result looks like this:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span> <span class="op">(</span><span class="va">xf</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 150 x 9
#&gt;    type  test_name  fn_name parameter  parameter_type operation  content   test 
#&gt;    &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;     &lt;lgl&gt;
#&gt;  1 dummy int_as_nu… var     x          integer vector Integer v… (Should … TRUE 
#&gt;  2 dummy vector_cu… var     x          vector         Custom cl… (Should … TRUE 
#&gt;  3 dummy vector_to… var     x          vector         Convert v… (Should … TRUE 
#&gt;  4 dummy negate_lo… var     na.rm      single logical Negate de… (Functio… TRUE 
#&gt;  5 dummy subst_int… var     na.rm      single logical Substitut… (Functio… TRUE 
#&gt;  6 dummy subst_cha… var     na.rm      single logical Substitut… should t… TRUE 
#&gt;  7 dummy single_pa… var     na.rm      single logical Length 2 … Should t… TRUE 
#&gt;  8 dummy return_su… var     (return o… (return objec… Check tha… &lt;NA&gt;      TRUE 
#&gt;  9 dummy return_va… var     (return o… (return objec… Check tha… &lt;NA&gt;      TRUE 
#&gt; 10 dummy return_de… var     (return o… (return objec… Check whe… &lt;NA&gt;      TRUE 
#&gt; # … with 140 more rows, and 1 more variable: yaml_hash &lt;chr&gt;</code></pre>
<p>The object returned from <code><a href="../reference/autotest_package.html">autotest_package()</a></code> is a simple <a href="https://tibble.tidyverse.org" class="external-link"><code>tibble</code></a>, with each row detailing one test which would be applied to the each of the listed functions and parameters. Because no tests were conducted, all tests will generally have a <code>type</code> of <code>"dummy"</code>. In this case, however, we see the following:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span> <span class="op">(</span><span class="va">xf</span><span class="op">$</span><span class="va">type</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   dummy warning </span>
<span class="co">#&gt;     148       2</span></code></pre></div>
<p>In addition to the 148 dummy tests, the function also returns 2 warnings, the corresponding rows of which are:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xf</span> <span class="op">[</span><span class="va">xf</span><span class="op">$</span><span class="va">type</span> <span class="op">!=</span> <span class="st">"dummy"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span> <span class="op">(</span><span class="st">"fn_name"</span>, <span class="st">"parameter"</span>, <span class="st">"operation"</span>, <span class="st">"content"</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 2 x 4</span>
<span class="co">#&gt;   fn_name parameter operation                    content                        </span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;                        &lt;chr&gt;                          </span>
<span class="co">#&gt; 1 var     use       Check that parameter usage … Examples do not demonstrate us…</span>
<span class="co">#&gt; 2 cov     y         Check that parameter usage … Examples do not demonstrate us…</span></code></pre></div>
<p>Although the <code>auotest</code> package is primarily intended to apply mutation tests to all parameters of all functions of a package, doing so requires identifying parameter types and classes through parsing example code. Any parameters of a function which are neither demonstrated within example code, nor given default values can not be tested, because it is not possible to determine their expected types. The above result reveals that neither the <code>use</code> parameter of the <code>var</code> function, nor the <code>y</code> parameter of <code>cov</code>, are demonstrated in example code, triggering a warning that these parameter are unable to be tested.</p>
</div>
<div id="conducting-tests" class="section level3">
<h3 class="hasAnchor">
<a href="#conducting-tests" class="anchor"></a>3.2 Conducting tests</h3>
<p>The 148 tests listed above with <code>type == "dummy"</code> can then be applied to all nominated functions and parameters by calling the same function with <code>test = TRUE</code>. Doing so yields the following results (as an object names <code>xt</code> for “true”):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autotest_package.html">autotest_package</a></span> <span class="op">(</span>package <span class="op">=</span> <span class="st">"stats"</span>,
                        functions <span class="op">=</span> <span class="st">"cor"</span>,
                        test <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; ── autotesting stats ──
#&gt; 
#&gt; ✔ [1 / 4]: var
#&gt; ✔ [2 / 4]: cor
#&gt; ✔ [3 / 4]: cov
#&gt; ✔ [4 / 4]: cov</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span> <span class="op">(</span><span class="va">xt</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 17 x 9
#&gt;    type   test_name  fn_name parameter parameter_type operation  content   test 
#&gt;    &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;     &lt;lgl&gt;
#&gt;  1 diagn… vector_to… var     x         vector         Convert v… "Functio… TRUE 
#&gt;  2 diagn… int_as_nu… var     x         integer vector Integer v… "Functio… TRUE 
#&gt;  3 diagn… vector_to… var     x         vector         Convert v… "Functio… TRUE 
#&gt;  4 diagn… int_as_nu… var     y         integer vector Integer v… "Functio… TRUE 
#&gt;  5 diagn… vector_to… var     y         vector         Convert v… "Functio… TRUE 
#&gt;  6 diagn… single_ch… cor     use       single charac… upper-cas… "is case… TRUE 
#&gt;  7 diagn… single_ch… cor     method    single charac… upper-cas… "is case… TRUE 
#&gt;  8 diagn… single_ch… cor     use       single charac… upper-cas… "is case… TRUE 
#&gt;  9 diagn… single_ch… cor     method    single charac… upper-cas… "is case… TRUE 
#&gt; 10 diagn… single_ch… cov     use       single charac… upper-cas… "is case… TRUE 
#&gt; 11 diagn… single_ch… cov     method    single charac… upper-cas… "is case… TRUE 
#&gt; 12 diagn… single_ch… cov     use       single charac… upper-cas… "is case… TRUE 
#&gt; 13 diagn… single_ch… cov     method    single charac… upper-cas… "is case… TRUE 
#&gt; 14 diagn… single_ch… cov     use       single charac… upper-cas… "is case… TRUE 
#&gt; 15 diagn… single_ch… cov     method    single charac… upper-cas… "is case… TRUE 
#&gt; 16 warni… par_is_de… var     use       &lt;NA&gt;           Check tha… "Example… TRUE 
#&gt; 17 warni… par_is_de… cov     y         &lt;NA&gt;           Check tha… "Example… TRUE 
#&gt; # … with 1 more variable: yaml_hash &lt;chr&gt;</code></pre>
<p>And the 148 tests yielded 17 unexpected responses. The best way to understand these results is to examine the object in detail, typically through <code><a href="https://rdrr.io/r/utils/edit.html" class="external-link">edit(xt)</a></code>, or equivalently in RStudio, clicking on the listed object. The different types of tests which produced unexpected responses were:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span> <span class="op">(</span><span class="va">xt</span><span class="op">$</span><span class="va">operation</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Check that parameter usage is demonstrated </span>
<span class="co">#&gt;                                          2 </span>
<span class="co">#&gt;       Convert vector input to list-columns </span>
<span class="co">#&gt;                                          3 </span>
<span class="co">#&gt;         Integer value converted to numeric </span>
<span class="co">#&gt;                                          2 </span>
<span class="co">#&gt;             upper-case character parameter </span>
<span class="co">#&gt;                                         10</span></code></pre></div>
<p>Two of those reflect the previous results regarding parameters unable to be tested, while the remainder come from only two types of tests. Information on the precise results is contained in the <code>content</code> column, although in this case it is fairly straightforward to see that the operation “upper case character parameter” arises because the <code>use</code> and <code>method</code> parameters of the <code>cor</code> and <code>cov</code> functions are case-dependent, and are only accepted in lower case form. The other operation is the conversion of vectors to list-column format, as described in the <a href="https://ropenscilabs.github.io/autotest/articles/autotest.html">first vignette</a>.</p>
</div>
<div id="controlling-which-tests-are-conducted" class="section level3">
<h3 class="hasAnchor">
<a href="#controlling-which-tests-are-conducted" class="anchor"></a>3.4 Controlling which tests are conducted</h3>
<p>The <code>test</code> parameter of the <a href="https://ropenscilabs.github.io/autotest/reference/autotest_package.html"><code>autotest_package()</code> function</a> can be used to control whether all tests are conducted or not. Finer-level control over tests can be achieved by specifying the <code>test_data</code> parameter. This parameter must be an object of class <code>autotest_package</code>, as returned by either the <a href="https://ropenscilabs.github.io/autotest/reference/autotest_types.html"><code>autotest_types()</code></a>] or [<code>autotest_package()](https://ropenscilabs.github.io/autotest/reference/autotest_package.html) functions. The former of these is the function which specifies all unique tests, and so returns a relatively small</code>tibble` of 27 rows. The following lines demonstrate how to switch off the list-column test for all functions and parameters:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">types</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autotest_types.html">autotest_types</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">types</span><span class="op">$</span><span class="va">test</span> <span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span> <span class="op">(</span><span class="st">"list_col"</span>, <span class="va">types</span><span class="op">$</span><span class="va">test_name</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>
<span class="va">xt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autotest_package.html">autotest_package</a></span> <span class="op">(</span>package <span class="op">=</span> <span class="st">"stats"</span>,
                         functions <span class="op">=</span> <span class="st">"cor"</span>,
                         test <span class="op">=</span> <span class="cn">TRUE</span>,
                         test_data <span class="op">=</span> <span class="va">types</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; ── autotesting stats ──
#&gt; 
#&gt; ✔ [1 / 4]: var
#&gt; ✔ [2 / 4]: cor
#&gt; ✔ [3 / 4]: cov
#&gt; ✔ [4 / 4]: cov</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span> <span class="op">(</span><span class="va">xt2</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 18 x 9
#&gt;    type   test_name  fn_name parameter parameter_type operation  content   test 
#&gt;    &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;     &lt;lgl&gt;
#&gt;  1 no_te… vector_to… var     x         vector         Convert v… (Should … FALSE
#&gt;  2 diagn… int_as_nu… var     x         integer vector Integer v… Function… TRUE 
#&gt;  3 diagn… int_as_nu… var     y         integer vector Integer v… Function… TRUE 
#&gt;  4 no_te… vector_to… var     y         vector         Convert v… (Should … FALSE
#&gt;  5 no_te… vector_to… cor     x         vector         Convert v… (Should … FALSE
#&gt;  6 no_te… vector_to… cor     y         vector         Convert v… (Should … FALSE
#&gt;  7 diagn… single_ch… cor     use       single charac… upper-cas… is case … TRUE 
#&gt;  8 diagn… single_ch… cor     method    single charac… upper-cas… is case … TRUE 
#&gt;  9 diagn… single_ch… cor     use       single charac… upper-cas… is case … TRUE 
#&gt; 10 diagn… single_ch… cor     method    single charac… upper-cas… is case … TRUE 
#&gt; 11 diagn… single_ch… cov     use       single charac… upper-cas… is case … TRUE 
#&gt; 12 diagn… single_ch… cov     method    single charac… upper-cas… is case … TRUE 
#&gt; 13 diagn… single_ch… cov     use       single charac… upper-cas… is case … TRUE 
#&gt; 14 diagn… single_ch… cov     method    single charac… upper-cas… is case … TRUE 
#&gt; 15 diagn… single_ch… cov     use       single charac… upper-cas… is case … TRUE 
#&gt; 16 diagn… single_ch… cov     method    single charac… upper-cas… is case … TRUE 
#&gt; 17 warni… par_is_de… var     use       &lt;NA&gt;           Check tha… Examples… TRUE 
#&gt; 18 warni… par_is_de… cov     y         &lt;NA&gt;           Check tha… Examples… TRUE 
#&gt; # … with 1 more variable: yaml_hash &lt;chr&gt;</code></pre>
<p>The result now has four rows with <code>test == FALSE</code>, and <code>type == "no_test"</code>, indicating that these tests were not actually conducted. That also makes apparent the role of these <code>test</code> flags. When initially calling <a href="https://ropenscilabs.github.io/autotest/reference/autotest_package.html"><code>autotest_package()</code></a> with default <code>test = FALSE</code>, the result contains a <code>test</code> column in which all values are <code>TRUE</code>. Although potentially perplexing at first, this value must be understood in relation to the <code>type</code> column. A <code>type</code> of <code>"dummy"</code> indicates that a test has not been conducted, in which case <code>test = TRUE</code> is a control flag used to determine what would be conducted if these data were submitted as the <code>test_data</code> parameter. For all <code>type</code> values other than <code>"dummy"</code>, the <code>test</code> column specifies whether or not each test was actually conducted.</p>
<p>The preceding example showed how the results of <a href="https://ropenscilabs.github.io/autotest/reference/autotest_types.html"><code>autotest_types()</code></a> can be used to control which tests are implemented for an entire package. Finer-scale control can be achieved by modifying individual rows of the full table returned by <a href="https://ropenscilabs.github.io/autotest/reference/autotest_package.html"><code>autotest_package()</code></a>. The following code demonstrates by showing how list-column tests can be switched off only for particular functions, starting again with the <code>xf</code> data of dummy tests generated above.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autotest_package.html">autotest_package</a></span> <span class="op">(</span>package <span class="op">=</span> <span class="st">"stats"</span>,
                        functions <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span>
<span class="va">xf</span><span class="op">$</span><span class="va">test</span> <span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span> <span class="op">(</span><span class="st">"list_col"</span>, <span class="va">xf</span><span class="op">$</span><span class="va">test_name</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">xf</span><span class="op">$</span><span class="va">fn_name</span> <span class="op">==</span> <span class="st">"var"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>
<span class="va">xt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autotest_package.html">autotest_package</a></span> <span class="op">(</span>package <span class="op">=</span> <span class="st">"stats"</span>,
                         functions <span class="op">=</span> <span class="st">"cor"</span>,
                         test <span class="op">=</span> <span class="cn">TRUE</span>,
                         test_data <span class="op">=</span> <span class="va">xf</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; ── autotesting stats ──
#&gt; 
#&gt; ✔ [1 / 4]: var
#&gt; ✔ [2 / 4]: cor
#&gt; ✔ [3 / 4]: cov
#&gt; ✔ [4 / 4]: cov
#&gt; ── autotesting stats ──
#&gt; 
#&gt; ✔ [1 / 4]: var
#&gt; ✔ [2 / 4]: cor
#&gt; ✔ [3 / 4]: cov
#&gt; ✔ [4 / 4]: cov</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span> <span class="op">(</span><span class="va">xt3</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 16 x 9
#&gt;    type   test_name  fn_name parameter parameter_type operation  content   test 
#&gt;    &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;     &lt;lgl&gt;
#&gt;  1 no_te… vector_to… var     x         vector         Convert v… (Should … FALSE
#&gt;  2 diagn… int_as_nu… var     x         integer vector Integer v… Function… TRUE 
#&gt;  3 diagn… int_as_nu… var     y         integer vector Integer v… Function… TRUE 
#&gt;  4 no_te… vector_to… var     y         vector         Convert v… (Should … FALSE
#&gt;  5 diagn… single_ch… cor     use       single charac… upper-cas… is case … TRUE 
#&gt;  6 diagn… single_ch… cor     method    single charac… upper-cas… is case … TRUE 
#&gt;  7 diagn… single_ch… cor     use       single charac… upper-cas… is case … TRUE 
#&gt;  8 diagn… single_ch… cor     method    single charac… upper-cas… is case … TRUE 
#&gt;  9 diagn… single_ch… cov     use       single charac… upper-cas… is case … TRUE 
#&gt; 10 diagn… single_ch… cov     method    single charac… upper-cas… is case … TRUE 
#&gt; 11 diagn… single_ch… cov     use       single charac… upper-cas… is case … TRUE 
#&gt; 12 diagn… single_ch… cov     method    single charac… upper-cas… is case … TRUE 
#&gt; 13 diagn… single_ch… cov     use       single charac… upper-cas… is case … TRUE 
#&gt; 14 diagn… single_ch… cov     method    single charac… upper-cas… is case … TRUE 
#&gt; 15 warni… par_is_de… var     use       &lt;NA&gt;           Check tha… Examples… TRUE 
#&gt; 16 warni… par_is_de… cov     y         &lt;NA&gt;           Check tha… Examples… TRUE 
#&gt; # … with 1 more variable: yaml_hash &lt;chr&gt;</code></pre>
<p>These procedures illustrate the three successively finer levels of control over tests, by switching them off for:</p>
<ol style="list-style-type: decimal">
<li>Entire packages;</li>
<li>Specified functions only; or</li>
<li>Specific parameters of particular functions only.</li>
</ol>
</div>
</div>
<div id="autotest-ing-your-package" class="section level2">
<h2 class="hasAnchor">
<a href="#autotest-ing-your-package" class="anchor"></a>4. <code>autotest</code>-ing your package</h2>
<p><code>autotest</code> can be very easily incorporated in your package’s <code>tests/</code> directory via to simple <a href="https://testthat.r-lib.org" class="external-link"><code>testthat</code></a> expectations:</p>
<ul>
<li>
<code>expect_autotest_no_testdata</code>, which will expect <code>autotest_package</code> to work on your package with default values including no additional <code>test_data</code> specifying tests which are not to be run; or</li>
<li>
<code>expect_autotest_testdata</code>, to be used when specific tests are switched off.</li>
</ul>
<p>Using these requires adding <code>autotest</code> to the <code>Suggests</code> list of your package’s <code>DESCRIPTION</code> file, along with <code>testthat</code>. Note that the use of testing frameworks other than <a href="https://testthat.r-lib.org" class="external-link"><code>testthat</code></a> is possible through writing custom expectations for the output of <a href="https://ropenscilabs.github.io/autotest/reference/autotest_package.html"><code>autotest_package()</code></a>, but that is not considered here.</p>
<p>To use these expectations, you must first decide which, if any, tests you judge to be not applicable to your package, and switch them off following the procedure described above (that is, at the package level through modifying the <code>test</code> flag of the object returned from <a href="https://ropenscilabs.github.io/autotest/reference/autotest_types.html"><code>autotest_types()</code></a>, or at finer function- or parameter-levels by modifying equivalent values in the object returned from <a href="https://ropenscilabs.github.io/autotest/reference/autotest_package.html"><code>autotest_package(..., test = FALSE)</code></a>. These objects must then be passed as the <code>test_data</code> parameter to <a href="https://ropenscilabs.github.io/autotest/reference/autotest_package.html"><code>autotest_package()</code></a>. If you consider all tests to be applicable, then <a href="https://ropenscilabs.github.io/autotest/reference/autotest_package.html"><code>autotest_package()</code></a> can be called without specifying this parameter.</p>
<p>If you switch tests off via a <code>test_data</code> parameter, then the <code>expect_autotest</code> expectation requires you to append an additional column to the <code>test_data</code> object called <code>"note"</code> (case-insensitive), and include a note for each row which has <code>test = FALSE</code> explaining why those tests have been switched off. Lines in your test directory should look something like this:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span> <span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org" class="external-link">testthat</a></span><span class="op">)</span> <span class="co"># as called in your test suite</span>
<span class="co"># For example, to switch off vector-to-list-column tests:</span>
<span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autotest_types.html">autotest_types</a></span> <span class="op">(</span>notest <span class="op">=</span> <span class="st">"vector_to_list_col"</span><span class="op">)</span>
<span class="va">test_data</span><span class="op">$</span><span class="va">note</span> <span class="op">&lt;-</span> <span class="st">""</span>
<span class="va">test_data</span><span class="op">$</span><span class="va">note</span> <span class="op">[</span><span class="va">test_data</span><span class="op">$</span><span class="va">test</span> <span class="op">==</span> <span class="st">"vector_to_list_col"</span><span class="op">]</span> <span class="op">&lt;-</span>
    <span class="st">"These tests are not applicable because ..."</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/expect_success.html" class="external-link">expect_success</a></span> <span class="op">(</span><span class="fu"><a href="../reference/expect_autotest_testdata.html">expect_autotest_testdata</a></span> <span class="op">(</span><span class="va">test_data</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>This procedure of requiring an additional <code>"note"</code> column ensures that your own test suite will explicitly include all explanations of why you deem particular tests not to be applicable to your package.</p>
<p>In contrast, the following expectation should be used when <code><a href="../reference/autotest_package.html">autotest_package()</a></code> passes with all tests are implemented, in which case no parameters need be passed to the expectation, and tests will confirm that no warnings or errors are generated.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://testthat.r-lib.org/reference/expect_success.html" class="external-link">expect_success</a></span> <span class="op">(</span><span class="fu"><a href="../reference/expect_autotest_no_testdata.html">expect_autotest_no_testdata</a></span> <span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="finer-control-over-testing-expectations" class="section level3">
<h3 class="hasAnchor">
<a href="#finer-control-over-testing-expectations" class="anchor"></a>4.2 Finer control over testing expectations</h3>
<p>The two expectations shown above call the <a href="https://ropenscilabs.github.io/autotest/reference/autotest_package.html"><code>autotest_package()</code></a> function internally, and assert that the results follow the expected pattern. There are also three additional <a href="https://testthat.r-lib.org" class="external-link"><code>testthat</code></a> expectations which can be applied to pre-generated <code>autotest</code> objects, to allow for finer control over testing expectations. These are:</p>
<ul>
<li>
<code>expect_autotest_no_err</code> to expect no errors in results from <code><a href="../reference/autotest_package.html">autotest_package()</a></code>;</li>
<li>
<code>expect_autotest_no_warn</code> to expect no warnings; and</li>
<li>
<code>expect_autotest_notes</code> to expect tests which have been switched off to have an additional <code>"note"</code> column explaining why.</li>
</ul>
<p>These tests are demonstrated in one of the testing files used in this package, which the following lines recreate to demonstrate the general process. The first two expectations are that an object be free from both warnings and errors. The tests implemented here are applied to the <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.html" class="external-link"><code>stats::cov()</code> function</a>, which actually triggers warnings because two parameters do not have their usage demonstrated in the example code. The tests therefore <code><a href="https://testthat.r-lib.org/reference/expect_success.html" class="external-link">expect_failure()</a></code>, when they generally should <code><a href="https://testthat.r-lib.org/reference/expect_success.html" class="external-link">expect_success()</a></code> throughout.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span> <span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org" class="external-link">testthat</a></span><span class="op">)</span> <span class="co"># as called in your test suite</span>
<span class="co"># For example, to switch off vector-to-list-column tests:</span>
<span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autotest_types.html">autotest_types</a></span> <span class="op">(</span>notest <span class="op">=</span> <span class="st">"vector_to_list_col"</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autotest_package.html">autotest_package</a></span> <span class="op">(</span>package <span class="op">=</span> <span class="st">"stats"</span>,
                       functions <span class="op">=</span> <span class="st">"cov"</span>,
                       test <span class="op">=</span> <span class="cn">TRUE</span>,
                       test_data <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span>
       
<span class="fu"><a href="https://testthat.r-lib.org/reference/expect_success.html" class="external-link">expect_success</a></span> <span class="op">(</span><span class="fu"><a href="../reference/expect_autotest_no_err.html">expect_autotest_no_err</a></span> <span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/expect_success.html" class="external-link">expect_failure</a></span> <span class="op">(</span><span class="fu"><a href="../reference/expect_autotest_no_warn.html">expect_autotest_no_warn</a></span> <span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># should expect_success!!</span></code></pre></div>
<pre><code>#&gt; ── autotesting stats ──
#&gt; 
#&gt; ✔ [1 / 4]: var
#&gt; ✔ [2 / 4]: cor
#&gt; ✔ [3 / 4]: cov
#&gt; ✔ [4 / 4]: cov</code></pre>
<p>The test files then affirms that simply passing the object, <code>x</code>, which has tests flagged as <code>type == "no_test"</code>, yet without explaining why in an additional <code>"note"</code> column, should cause <code>expect_autotest()</code> to fail. The following line, removing the logical <code>testthat</code> expectation, demonstrates:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/expect_autotest_notes.html">expect_autotest_notes</a></span> <span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; Error: Any autotest tests which are switched off should have explanatory notes in a 'note' column</code></pre>
<p>As demonstrated above, these <code>expect_autotest_...</code> calls should always be wrapped in a direct <a href="https://testthat.r-lib.org" class="external-link"><code>testhat</code></a> expectation of <a href="https://testthat.r-lib.org/reference/expect_success.html" class="external-link"><code>expect_success()</code></a>. To achieve success in that case, we need to append an additional <code>"note"</code> column containing explanations of why each test has been switched off:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">$</span><span class="va">note</span> <span class="op">&lt;-</span> <span class="st">""</span>
<span class="va">x</span> <span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span> <span class="op">(</span><span class="st">"vector_to_list"</span>, <span class="va">x</span><span class="op">$</span><span class="va">test_name</span><span class="op">)</span>, <span class="st">"note"</span><span class="op">]</span> <span class="op">&lt;-</span>
  <span class="st">"these tests have been switched off because ..."</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/expect_success.html" class="external-link">expect_success</a></span> <span class="op">(</span><span class="fu"><a href="../reference/expect_autotest_notes.html">expect_autotest_notes</a></span> <span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>In general, using <code>autotest</code> in a package’s test suite should be as simple as adding <code>autotest</code> to <code>Suggests</code>, and wrapping either <code>expect_autotest_no_testdata</code> or <code>expect_autotest_testdata</code> in an <code>expect_success</code> call.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Mark Padgham.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
